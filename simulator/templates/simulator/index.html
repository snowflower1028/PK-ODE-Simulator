<!DOCTYPE html>
<html lang="en">
<head>
  {% load static %}
  <meta charset="UTF-8">
  <title>PK Simulator - Dosing</title>
  <link rel="stylesheet" href="{% static 'simulator/css/style.css' %}">
  <script defer src="{% static 'simulator/js/dosing.js' %}"></script>
  <style>
    body { font-family: sans-serif; padding: 2rem; max-width: 800px; margin: auto; }
    .dose-card {
      background: #f8fbff;
      border-left: 5px solid #4A90E2;
      padding: 12px;
      margin-bottom: 12px;
      border-radius: 8px;
    }
    .dose-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    button { cursor: pointer; }
  </style>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <h2>ğŸ§® ODE System</h2>
  <textarea id="ode-input" rows="5" style="width:100%;">
  dCdt = -kel * C - kon * C * R + koff * CR
  dRdt = -kon * C * R + koff * CR + kdeg * CR
  dCRdt = kon * C * R - koff * CR - kint * CR
  </textarea>
  <br>
  <button onclick="parseODE()">ğŸ§  Parse Equations</button>

  <h3>ğŸ§¬ Initial Values</h3>
  <div id="init-values"></div>

  <h3>âš™ï¸ Parameter Values</h3>
  <div id="param-values"></div>

  <h2>ğŸ§ª Dosing Input for PK Simulation</h2>

  <!-- ğŸš€ Dosing ì…ë ¥ í¼ -->
  <form id="dose-form">
    <label>
      Compartment:
      <input type="text" id="compartment" required>
    </label>
    <br>
    <label>
      Type:
      <select id="type">
        <option value="bolus">IV Bolus</option>
        <option value="infusion">IV Infusion</option>
      </select>
    </label>
    <br>
    <label>
      Amount:
      <input type="number" id="amount" min="0" step="any" required>
    </label>
    <br>
    <label>
      Start Time:
      <input type="number" id="start_time" min="0" step="any" required>
    </label>
    <br>
    <label id="duration-label" style="display: none;">
      Infusion Duration:
      <input type="number" id="duration" min="0" step="any">
    </label>
    <br>
    <label>
      Repeat every (hours):
      <input type="number" id="repeat_every" min="0" step="any">
    </label>
    <br>
    <label>
      Repeat until (hours):
      <input type="number" id="repeat_until" min="0" step="any">
    </label>
    <br><br>
    <button type="submit">â• Add Dose</button>
  </form>

  <hr>

  <!-- ğŸ’‰ ë“±ë¡ëœ dose ëª©ë¡ -->
  <h2>ğŸ’‰ Registered Doses</h2>
  <div id="dose-list"></div>
  <h2>ğŸ“ˆ Simulation Result</h2>
  <div id="plot" style="width: 100%; height: 500px;"></div>
  <br>
<button id="simulate-btn" style="margin-top: 20px;">ğŸš€ Run Simulation</button>
</body>
</html>

